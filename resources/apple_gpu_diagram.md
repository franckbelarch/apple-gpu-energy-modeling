# Apple GPU Architecture Diagrams

## Apple M1/M2/M3 GPU High-Level Architecture

```
┌───────────────────────────────────────────────────────────────────┐
│                        Apple SoC (e.g., M2 Pro)                    │
│                                                                   │
│  ┌─────────────┐   ┌─────────────┐   ┌──────────────────────┐    │
│  │             │   │             │   │                      │    │
│  │  CPU Cores  │   │Neural Engine│   │      GPU Cores       │    │
│  │  (P + E)    │   │             │   │                      │    │
│  │             │   │             │   │                      │    │
│  └──────┬──────┘   └──────┬──────┘   └──────────┬───────────┘    │
│         │                 │                     │                 │
│         └─────────┬───────┴─────────┬───────────┘                 │
│                   │                 │                             │
│           ┌───────┴─────────┐       │                             │
│           │                 │       │                             │
│           │ System Level    │       │                             │
│           │ Cache           │       │                             │
│           │                 │       │                             │
│           └───────┬─────────┘       │                             │
│                   │                 │                             │
│                   └────────┬────────┘                             │
│                            │                                      │
│                  ┌─────────┴──────────┐                           │
│                  │                    │                           │
│                  │   Unified DRAM     │                           │
│                  │   Controller       │                           │
│                  │                    │                           │
│                  └──────────┬─────────┘                           │
│                             │                                     │
└─────────────────────────────┼─────────────────────────────────────┘
                              │
               ┌──────────────┴──────────────┐
               │                             │
               │    Unified Memory (RAM)     │
               │                             │
               └─────────────────────────────┘
```

## GPU Core Architecture Detail

```
┌───────────────────────────────────────────────────────────────────┐
│                        GPU Core Cluster                            │
│                                                                   │
│  ┌─────────────────────┐   ┌─────────────────────┐                │
│  │     Shader Core     │   │     Shader Core     │                │
│  │                     │   │                     │                │
│  │  ┌───────────────┐  │   │  ┌───────────────┐  │                │
│  │  │ ALU Units     │  │   │  │ ALU Units     │  │                │
│  │  └───────────────┘  │   │  └───────────────┘  │                │
│  │                     │   │                     │                │
│  │  ┌───────────────┐  │   │  ┌───────────────┐  │                │
│  │  │ Texture Units │  │   │  │ Texture Units │  │                │
│  │  └───────────────┘  │   │  └───────────────┘  │                │
│  │                     │   │                     │                │
│  │  ┌───────────────┐  │   │  ┌───────────────┐  │                │
│  │  │ Special Func  │  │   │  │ Special Func  │  │                │
│  │  │ Units (SFU)   │  │   │  │ Units (SFU)   │  │                │
│  │  └───────────────┘  │   │  └───────────────┘  │                │
│  │                     │   │                     │                │
│  │  ┌───────────────┐  │   │  ┌───────────────┐  │                │
│  │  │ Load/Store    │  │   │  │ Load/Store    │  │                │
│  │  │ Units         │  │   │  │ Units         │  │                │
│  │  └───────────────┘  │   │  └───────────────┘  │                │
│  │                     │   │                     │                │
│  └─────────┬───────────┘   └────────┬────────────┘                │
│            │                        │                             │
│            └────────────┬───────────┘                             │
│                         │                                         │
│             ┌───────────┴───────────┐                             │
│             │                       │                             │
│             │   L1 Cache/Tile Mem   │                             │
│             │                       │                             │
│             └───────────┬───────────┘                             │
│                         │                                         │
│             ┌───────────┴───────────┐                             │
│             │                       │                             │
│             │   L2 Cache            │                             │
│             │                       │                             │
│             └───────────┬───────────┘                             │
│                         │                                         │
└─────────────────────────┼─────────────────────────────────────────┘
                          │
                ┌─────────┴───────────┐
                │                     │
                │  System Level Cache │
                │                     │
                └─────────┬───────────┘
                          │
                ┌─────────┴───────────┐
                │                     │
                │  Unified Memory     │
                │                     │
                └─────────────────────┘
```

## Tile-Based Deferred Rendering Pipeline

```
┌────────────────────────────────────┐
│ Scene Geometry                     │
└──────────────────┬─────────────────┘
                   │
                   ▼
┌────────────────────────────────────┐
│ Vertex Shading                     │
└──────────────────┬─────────────────┘
                   │
                   ▼
┌────────────────────────────────────┐
│ Tile Binning                       │
└──────────────────┬─────────────────┘
                   │
                   ▼
┌────────────────────────────────────┐
│ Visibility Determination           │
│ (Hidden Surface Removal)           │
└──────────────────┬─────────────────┘
                   │
                   ▼
┌────────────────────────────────────┐
│ Fragment Shading (only visible     │
│ fragments are processed)           │
└──────────────────┬─────────────────┘
                   │
                   ▼
┌────────────────────────────────────┐
│ Tile Memory Operations             │
│ (blending, etc.)                   │
└──────────────────┬─────────────────┘
                   │
                   ▼
┌────────────────────────────────────┐
│ Tile Write-Back to Main Memory     │
└────────────────────────────────────┘
```

## M3 GPU Features Comparison

| Feature | M3 | M3 Pro | M3 Max | M3 Ultra |
|---------|-----|--------|---------|----------|
| GPU Cores | 10 | Up to 18 | Up to 40 | Up to 76 |
| Memory Bandwidth | ~100 GB/s | ~150 GB/s | ~400 GB/s | ~800 GB/s |
| Ray Tracing | ✓ | ✓ | ✓ | ✓ |
| Mesh Shading | ✓ | ✓ | ✓ | ✓ |
| Dynamic Caching | ✓ | ✓ | ✓ | ✓ |
| Hardware-Accelerated ML | ✓ | ✓ | ✓ | ✓ |

## Power Management Architecture

```
┌────────────────────────────────────────────────────────────┐
│                    System Management Controller            │
└───────────────────────────┬────────────────────────────────┘
                           │
         ┌─────────────────┼────────────────────┐
         │                 │                    │
         ▼                 ▼                    ▼
┌──────────────┐  ┌──────────────┐  ┌───────────────────┐
│ Thermal      │  │ Performance  │  │ Power Delivery    │
│ Monitoring   │  │ Monitoring   │  │ Subsystems        │
└───────┬──────┘  └───────┬──────┘  └─────────┬─────────┘
        │                 │                   │
        └─────────────────┼───────────────────┘
                          │
                          ▼
┌──────────────────────────────────────────────────────────┐
│                   Power Management Unit                   │
└──────────────────────────┬───────────────────────────────┘
                           │
         ┌─────────────────┼─────────────────┐
         │                 │                 │
         ▼                 ▼                 ▼
┌──────────────┐  ┌──────────────┐  ┌──────────────┐
│ CPU          │  │ GPU          │  │ Neural       │
│ Power Gates  │  │ Power Gates  │  │ Engine Gates │
└──────────────┘  └──────────────┘  └──────────────┘

```

## Energy Flow in GPU Pipeline

```
┌───────────────────────────────────────────────────────────────────┐
│                 Energy Distribution in GPU Pipeline               │
│                                                                   │
│  Power Draw:                                                      │
│  Low ◄───────────────────────────────────────────────────► High  │
│                                                                   │
│  ┌────────────┐   ┌────────────┐   ┌────────────┐   ┌────────────┐│
│  │            │   │            │   │            │   │            ││
│  │ Vertex     │   │ Texture    │   │ Fragment   │   │ Memory     ││
│  │ Processing │◄─►│ Sampling   │◄─►│ Shading    │◄─►│ Operations ││
│  │            │   │            │   │            │   │            ││
│  └────────────┘   └────────────┘   └────────────┘   └────────────┘│
│                                                                   │
│  Primary Energy Optimizations:                                    │
│                                                                   │
│  ┌────────────────────┐  ┌────────────────────┐  ┌───────────────┐│
│  │ 1. Tile Memory     │  │ 2. Hidden Surface  │  │ 3. Dynamic    ││
│  │    Usage           │  │    Removal         │  │    Clocking   ││
│  └────────────────────┘  └────────────────────┘  └───────────────┘│
│                                                                   │
└───────────────────────────────────────────────────────────────────┘
```